---
title: |
  | [A presentation of ThreeME]{style="font-size: 0.75em;letter-spacing: 2px;line-height: 0.8;"}
subtitle:  |
  | [Place]{style="color: grey;font-size: 0.95em;letter-spacing: 1px;line-height: 0.25;"}
  | [Seminar XXXX]{style="color: blue;font-size: 0.95em;letter-spacing: 1px;line-height: 0.25;"}
author: "ThreeME Team"
date: "`r format(Sys.Date(), '%d %B %y')`"
format: 
  pres-revealjs:
    toc-depth: 1
    css: styles.css
transition: slide
transition-speed: fast  

  
---

```{r setup, include=FALSE}


knitr::opts_chunk$set(
	echo = FALSE,
	message = FALSE,
	warning = FALSE,
	results = "hide"
)
```

## Welcome {.center} 

:::: {.columns}

::: {.column width="40%" .center}

<br>

![](pictures/Logohacienda.png){fig-align="center" fig-width=30%}

:::

::: {.column width="30%"}

<br>
<br>
<br>
<br>

![](pictures/AFD_logo.png){fig-align="center" fig-width=30%}




:::

::: {.column width="30%"}

<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>

![](pictures/ofce_m.png){fig-align="center" fig-width=30%}
![](pictures/sciencespo.png){fig-align="center" fig-width=30%}

:::

::::

# Overview of the model

## The ThreeME model   {.scrollable}

-   **M**ulti-sector **M**acroeconomic **M**odel for the **E**valuation of **E**nvironmental and **E**nergy policy

-   Macroeconomic multi-sector model with neo-keynesian features

    -   Avoid the limitations of standard CGE models
        -   Say something about the medium term (not only the long term)
        -   More realistic results for policy makers
    -   Similar dynamic and long term properties than the macroeconomic models used in Economic ministries and forecasting departments
    
-   **Open source** model: www.threeme.org

    -   To avoid usual criticisms on models: black-box, impossible to verify independently the results, too few users
    -   Make application to other countries and by other institutions easier: EU, Mexico & Indonesia (AFD); Tunisia (UNEP), UK (OECD), Luxembourg (Statec), DG Trésor

## Multisector model   {.scrollable}

-   n sectors (e.g. France: n = 37; Tunisia: n = 21, Mexico: n = 24, Luxembourg: n = 26)

-   Allows to analyze the effect of transfer of activities from one sector to another on:

    -   **Employment**, due to different labor intensity
    -   **Investment**, due to different capital intensity
    -   **Energy consumption**, due to different energy intensity
    -   **Trade balance**, due to different propensity to import and export

### Example of sectoral decomposition

-   The economy is disaggregated into **27 sectors**, with in particular:

    -   4 transport sectors
    -   12 energy sectors of which 10 technologies for the production of electricity
        
-   and **23 commodities**

    -   A commodity can be produced by several sectors. E.g. electricity
        
-   The **disaggregation is a compromise** between the availability of the national account and energy data and the objective of the model

-   Several sectors have to be disaggregated

    -   Electricity and gas
    -   Transport

## Example of sectoral decomposition  {.scrollable}
![](pictures/desagregation.jpg){fig-align="center" width="80%"}

## Focus on energy   {.scrollable}

-   The energy disaggregation allows for analyzing the energy behavior of economic agents:

    -   **Sectors** can arbitrate between different energy investments:
        -   Substitution between capital & energy when the relative energy price increases
        -   Substitution between energy sources
        -   Substitution between transports
        -   Endogenous energy efficiency: technical progress increases when the relative energy price increases
        
    -   **Consumers**
        -   Substitution between capital & energy
        -   Substitution between energy sources
        -   Substitution between transports
        -   Substitution between goods

## Type of simulation of the economic and environmental impact   {.scrollable}

-   **Energy transition policies**

    -   Fiscal policies:
        -   Carbon tax with or without redistribution of the tax revenue
        -   Phasing out subsidies on (fossil fuel) energy
        -   Bonus-malus for cars: subsidies on green cars financed by a tax on other cars
    -   Change in the electricity production mix
        -   Ex: more RES in the mix
    -   Impact of green investment
        -   In buildings, public transport, etc.
        -   Impact of applying a new standard for buildings, or appliances
        
-   **External shock**

    -   Increase in international oil/gas price

## CGE model   {.scrollable}

-   **Computable:** numerical simulation
-   **General:** take into account the interactions between markets.

    -   Supply and demand influence each other
    
-   **Equilibrium:** Supply is equal to demand on all markets (good, production factors)

-   Structure of a CGE model (see next Figure):

    -   Demand (Consumption, investment) defines the supply (production)
    -   Supply defines in return the demand through the incomes generated by the production factors

## CGE model

![](pictures/schema.png){fig-align="center" width="80%"}

## What does ***general equilibrium*** mean?   {.scrollable}

-   General Equilibrium relates to a state where supply is equal to demand in all markets
-   2 main approaches to insure this state:

    -   **Walrasian** models
        -   The equilibrium force is the price system
        -   Perfect price flexibility insure the instantaneous equilibrium between supply and demand
        -   When the supply of a commodity goes down, its price tends to go up, thereby stimulating additional supply and depressing demand, until supply and demand are equal again.
        
        -   Static model
    -   **Neo-Keynesian** models
        -   Demand determines supply in the short run
        -   Price and quantities are rigid and adjust slowly
        -   Disequilibrium between notional (optimal) supply and the actual supply in the short run
        -   Dynamic model: transition to the long run

## A neo-keynesian CGE model   {.scrollable}

-   **Slow adjustment** of price and quantity

    -   Adjustment costs
    -   Empirically firms adjust their production to the demand rather than their price

-   Leads to situation of **disequilibrium** between the desired supply and demand

-   **Prices** are defined as a mark-up over the firm's production costs

    -   Production costs integrate intermediary consumption (material and energy), labor and capital costs

-   Wages are determined by a **Wage Setting (WS) curve**

    -   Phillips curve: wages increase with inflation and decrease with unemployment
    -   Wages do not adjust instantaneously the supply and demand for labor:
        -   Permanent underemployment equilibrium possible
        -   Theory of the NAIRU (Non Accelerating Inflation Rate of Unemployment) or Equilibrium rate of unemployment
        
-   The **interest rate** does not equilibrate instantaneously saving and investment:

    -   It is defined by the Central Bank
    -   "Taylor" reaction function: increases with inflation, decreases with unemployment

## Key properties of ThreeME   {.scrollable}

-   **General equilibrium effects**

    -   Supply influence demand and vice versa
    
-   **Direct and indirect effects** of the energy transition

    -   Direct effects: impact for the energy sectors
    -   Indirect effects: impact for the rest of the economy (in particular the other sectors, the government, households).
    
-   **Limited eviction effects**

    -   Investment is not only defined by saving
    -   The financing through bank credit does not necessary lead to an increase of the interest rate
    -   The augmentation of investment in one sector is not necessary achieved through a decrease of investment in other sectors

## The value-added compared to existing models   {.scrollable}

-   Sectorial disaggregation

    -   Make explicit the negative and positive impacts for each sector according to its own specificities.\
-   High technological disaggregation of the energy system

    -   Ex: electricity produced by several technology
    -   Each technology having their own cost and production function
    -   Link between economic activity, energy production in physical terms (Mtoe or Mwh) and CO2 emissions more accurate.
    
-   General Equilibrium

    -   Allows for taking into account of indirect and feedback effects (rebound effects)
    
-   Neo-keynesian features

    -   Allows for studying transition and disequilibrium phases (such underemployment)

## The value-added compared to existing models   {.scrollable}

-   Hybrid modelling

    -   Link bottom-up and top-down approaches
    -   Detailed energy technologies and coherent macroeconomic framework
    
-   Possibility of combination with an energy system model

    -   The bottom-up development of the energy sectors makes it possible to combine ThreeME with an energy system model without loss of relevant information
    -   Assessment of scenarios compatible with the technical constraints regarding the feasible energy mix.

![](pictures/schema2.png){fig-align="center" width="80%"}

## Data: Supply-Use (SU) and Input-Output (IO) tables   {.scrollable}

-   SU table says how much a given commodities is supplied by a given sector (Supply)

    -   Generally close to a diagonal matrix
    
-   IO table says how much a given commodities is purchased by a given sector (Demand)

    -   Not a diagonal matrix

![](pictures/Simplified_SU_IO.png){fig-align="center" width="80%"}

## Equilibrium between Supply and Demand (use)   {.scrollable}

-   GDP = VA = Y -- CI = C + I + X - M

![](pictures/schema3.png){fig-align="center" width="80%"}

# Main equations

## Adjustment mechanisms   {.scrollable}

-   ThreeME takes into account explicitly the **slow adjustment of prices and quantities** (factors of production, consumption)

-   ThreeME assumes that the **actual** levels of prices and quantities gradually adjust to their **notional** level 

-   The **notional** level corresponds to the **optimal (desired or target)** level that the economic agent would choose in the absence of adjustment constraints

-   **Microeconomic foundation** for a slow adjustment process:  

    -   Adjustment models: Eisner and Strotz (1963) and Gould (1968), Lucas (1967), Schramm (1970) and Treadway (1971), Rotemberg (1982) 
    
    -  The adjustment process is derived from an optimal behavior: **minimizing an adjustment cost function** (Rotemberg,1982) 
 
## Adjustment mechanisms   {.scrollable}
    
- **Adjustment process** and **expectations** for prices and quantities represented by the following equations:

\begin{equation}
\label{eq-efective_adjustement}
\small
\operatorname{log} X_{t} = \alpha^{{0},X} \; \operatorname{log} X^{n}_{t} + \left( 1 - \alpha^{{0},X} \right) \; \left( \operatorname{log} X_{t-1} + \varDelta \left(\operatorname{log} X^{e}_{t}\right) \right)
\end{equation}

\begin{equation}
\small
\begin{split}
\label{eq-expected_adjustement}
\varDelta \left(\operatorname{log} X^{e}_{t}\right) = \alpha^{{1},X} \; \varDelta \left(\operatorname{log} X^{e}_{t-1}\right) + \alpha^{{2},X}\; \varDelta \left(\operatorname{log} X_{t-1}\right) \\ 
+ \alpha^{{3},X} \; \varDelta \left(\operatorname{log} X^{n}_t\right) + \alpha^{{4},X} \; \varDelta \left(\operatorname{log} X_{t+1}\right)
\end{split}
\end{equation}

Where $X_{t}$ is the effective value of a given variable, $X^{n}_t$ is its notional level, $X^{e}_t$ its expected (anticipated) value at period $t$ and $\alpha^{{i},X}$ are the adjustments parameters, with $\alpha^{{1},X} + \alpha^{{2},X} + \alpha^{{3},X}  + \alpha^{{4},X} = 1$.

## Adjustments: Minimizing an adjustment cost function   {.scrollable}

- To take into account that the changes in price are all the more costly that they are large propose to use **quadratic adjustment cost** models (Rotemberg, 1982).     
- The firm defines the optimal price as a trade-off between the **cost of adjusting** and the **cost of not been adjusted**.

\begin{equation}
  \Gamma_t\left(X_t\right)-\Gamma_t\left(X_t^n\right)=\Gamma_t^{\prime}\left(X_t^n\right)\left(X_t-X_t^n\right)+\Gamma_t^{\prime \prime}\left(X_t^n\right)\left(X_t-X_t^n\right)^2
\end{equation}
The profit being maximum for $X_t^n, \Gamma_t^{\prime}\left(X_t^n\right)=0$ and $\Gamma_t^{\prime \prime}\left(X_t^n\right)<0$. As a first approximation, the adjustment cost, i.e. the loss of profit suffered by a company that is not in the optimum, is therefore:
$$
  C_D=\Gamma_t\left(X_t^n\right)-\Gamma_t\left(X_t\right)=C_D\left(X_t-X_t^n\right)^2
$$
Where:
$$
  C_D=-\Gamma_t^{\prime \prime}\left(X_t^n\right)
$$
Suppose that the adjustment cost is proportional to the square of the speed of adjustment:
$$
  C_A=c_A\left(X_t-X_{t-1}\right)^2
$$
Where:
$$
  c_A>0
$$
Minimizing the total cost function $\left(C_t=C_D+C_A\right)$ is equivalent to solving:
$$
  C_t^{\prime}\left(X_t\right)=2 c_D\left(X_t-X_t^n\right)+2 c_A\left(X_t-X_{t-1}\right)=0
$$
The condition of the second order $\left(C_t^{\prime \prime}\left(X_t\right)>0\right)$ being always verified, the optimal adjustment which minimizes the total cost has the following dynamic process:
$$
  X_t=\alpha X_t^n+(1-\alpha) X_{t-1}
$$
With:
$$
  \alpha=\frac{c_D}{\left(c_D+c_A\right)}
$$

With this simple model, the average adjustment time is:
$$
  \frac{\alpha}{(1-\alpha)}=\frac{c_D}{c_A}
$$
**The slower the adjustment, the higher the adjustment cost $c_A$  compared to the cost of non being adjusted $c_D$**.



## Production of commodities of each sector {.scrollable}


- The production of a commodity can be produced by several sectors:

$$Y_{c, s} = \varphi^{Y}_{c, s} \; YQ_{c}$$

- $YQ_c$ : aggregated domestic production of commodity $c$. It is determined by the demand (intermediate and final consumption, investment, public spending, exports and stock variation).
- $PhiY_{c, s}$ : share of commodity $c$ produced by the sector $s$ (with $\sum_{s} phiY_{c,s} =1$) 

- Aggregated production of sector $s$:

$$Y_{s} = \sum_{s} Y_{c, s}$$


## Structure of production {.scrollable}

![](pictures/production_structure.jpg)


## Demand for production factors    {.scrollable}

- Notional production factors demand derived from a production **costs minimization** program assuming a **Variable Output Elasticity (VOE) Cobb–Douglas production function** 

    -   more flexible production function than the CES function:  elasticity of substitution can differ between pair of inputs
    - Reynès, F. (2019). The Cobb–Douglas function as a flexible function: A new perspective on homogeneous functions through the lens of output elasticities. Mathematical Social Sciences, 97, 11-17.

$$\varDelta \left(\operatorname{log} F^{n}_{f, s}\right) = \varDelta \left(\operatorname{log} Y_{s}\right) - \varDelta \left(\operatorname{log} PROG_{f, s}\right) + \varDelta \left(SUBST^{F}_{f, s}\right)$$

$$\varDelta \left(SUBST^{F,n}_{f, s}\right) = \sum_{ff} -ES_{f, ff, s} \; \varphi_{ff, s, t-1} \; \varDelta \left(\operatorname{log} \frac{C_{f, s}}{PROG_{f, s}} - \operatorname{log} \frac{C_{ff, s}}{PROG_{ff, s}}\right)$$

- Input (cost) share: $$\varphi_{f, s} = \frac{C_{f, s} \; F^{n}_{f, s}}{\sum_{ff} C_{ff, s} \; F^{n}_{ff, s}}$$
- Notional demand of input $f$ ($KLEM$): $F_{f,s}^n$
- Elasticity of substitution (ES) between the pairs of inputs $f$ and $ff$: $ES_{f,ff,s}$
- Technical progress related to input $f$: $PROG_{f,s}$
- Cost/price of input $f$: $C_{f,s}$
- Production of sector $s$: $Y_{s}$

##  Nested CES production function {.schrollable}


![](pictures/nested_CES.jpg)

##  Nested CES production function {.schrollable}

- At the first level, material (M) can be substituted with the aggregate capital/energy/labor (KEL) with an ES of $\sigma^{NEST^{MAT,KEL}}$ . 
- At the second level, the aggregate capital/energy (KE) is a substitute to labor (L) with an ES of $\sigma^{NEST^{KE,L}}$. 
- At the third level, capital (K) can be substituted to energy (E) with an ES of $\sigma^{NEST^{K,E}}$. 

$$ES_{K, E, s} = \frac{\eta^{NEST^{K,E}}_{s}}{\left( 1 - \varphi_{MAT, s} - \varphi_{L, s} \right) - \frac{\eta^{NEST^{MAT,KEL}}_{s}}{\left( 1 - \varphi_{MAT, s} \right) - \eta^{NEST^{KE,L}}_{s} \; \frac{\varphi_{L, s}}{\frac{1 - \varphi_{MAT, s}}{1 - \varphi_{MAT, s} - \varphi_{L, s}}}}}$$

$$ES_{K, L, s} = \frac{\eta^{NEST^{KE,L}}_{s} - \eta^{NEST^{MAT,KEL}}_{s} \; \varphi_{MAT, s}}{1 - \varphi_{MAT, s}}$$


## Investment and capital {.scrollable}

Investment in ThreeME depends on the anticipated production, on its past dynamic, on substitution phenomena and on a correction mechanism, which guaranties that companies reach their level of long-term notional capital stock. The stock of capital is deducted from the investment according to the standard capital accumulation equation:

\begin{equation}
\small
\begin{split}
\varDelta \left(\operatorname{log} IA_{s}\right) = \alpha^{IA,Ye}_{s} \; \varDelta \left(\operatorname{log} Y^{e}_{s}\right) + \alpha^{IA,IA1}_{s} \; \varDelta \left(\operatorname{log} IA_{s, t-1}\right) \\
+ \alpha^{IA,SUBST}_{s} \; \varDelta \left(SUBST^{F}_{K, s}\right) \\
+ \alpha^{IA,Kn}_{s} \; \left( \operatorname{log} F^{n}_{K, s, t-1} - \operatorname{log} F_{K, s, t-1} \right)
\end{split}
\end{equation}

\begin{equation}
\small
F_{K, s} = \left( 1 - \delta_{s} \right) \; F_{K, s, t-1} + IA_{s}
\end{equation}

## Price setting {.scrollable}

The production price for each sector is set by applying a mark-up over the unit cost of
production (which includes labor, capital, energy and other intermediate consumption
costs):

\begin{equation}
\small
PY^{n}_{s} = CU^{n}_{s} \; \left( 1 + \mu_{s} \right)
\end{equation}

Where $PY^n$ is the notional price, $CU^n_s$ the unitary cost of production and $\mu_{s}$ is the mark-up.

## Price setting {.scrollable}

**Notional mark-up of the sector $s$**: the default notional mark-up is a positive function of the capacity utilization ratio.

\begin{equation}
\small
\varDelta \left(\operatorname{log} \left(1 + \mu^{n}_{s}\right)\right) = \rho^{\mu,Y} . \varDelta \left(\operatorname{log} CUR_{s}\right)
\end{equation}

\begin{equation}
\small
CUR_{s} = \frac{Y_{s}}{YCAP_{s}}
\end{equation}

\begin{equation}
\small
\begin{split}
\varDelta \left(\operatorname{log} YCAP_{s}\right) = \sum_{f} \varphi_{f, s, t-1} \; \varDelta \left(\operatorname{log} \left(F_{f, s} \; PROG_{f, s}\right)\right) \\
+ \alpha^{YCAP,Y}_{s} \; \left( \operatorname{log} Y_{s, t-1} - \operatorname{log} \left(YCAP_{s, t-1} \; CUR_{s, t_0}\right) \right)
\end{split}
\end{equation}

## Wage setting {.scrollable}

In ThreeME, we choose a general specification that includes the Phillips and Wage Setting (WS) curves. It assumes that the notional nominal wage ($W^n_s$) positively depends on the anticipated consumption price ($P^e$) and on the labor productivity ($PROG^L_s$), and negatively on the unemployment rate ($UnR$): 

\begin{equation}
\small
\begin{split}
\varDelta \left(\operatorname{log} W^{n}_{s}\right) = \rho^{W,Cons}_{s} + \rho^{W,P}_{s} \; \varDelta \left(\operatorname{log} P\right) + \rho^{W,Pe}_{s} \; \varDelta \left(\operatorname{log} P^{e}\right) \\
+ \rho^{W,PROG}_{s} \; \varDelta \left(\operatorname{log} PROG^{L}_{s}\right) - \rho^{W,U}_{s} \; \left( UnR - DNAIRU \right) \\
- \rho^{W,DU}_{s} \; \varDelta \left(UnR\right) + \rho^{W,L}_{s} \; \varDelta \left(\operatorname{log} F_{L, s} - \operatorname{log} F_{L}\right)
\end{split}
\end{equation}

This relation can alternatively be identical, either to the Phillips curve, or to the WS curve depending on the value of the selected parameters (Heyer et al., 2007; Reynès, 2010).

## Interest rate {.scrollable}

In the neo-Keynesian framework, it is standard to assume that the interest rate is set
by the Central Bank (CB) according to a Taylor rule (Taylor, 1993). The real interest
rate is a positive function of inflation and a negative function of unemployment rate
(here used as a proxi of the output gap):

\begin{equation}
\small
\varDelta \left(R^{n}\right) = \rho^{Rn,P} . \varDelta \left(\frac{\varDelta \left(P\right)}{P_{t-1}}\right) - \rho^{Rn,UnR} . \varDelta \left(UnR\right)
\end{equation}

## Households’ consumption {.scrollable}

We assume that the notional (optimal) aggregate households consumption corresponds to a share of their current income:

\begin{equation}
\small
CH^{n,VAL} = DISPINC^{AT,VAL} . \left( 1 - MPS^{n} \right)
\end{equation}

Where $CH^{n,VAL}$ is the  aggregate notional households final consumption expressed in value, $DISPINC^{AT,VAL}$ is the households’ disposable income and $MPS^n$ their notional marginal propensity to save, defined as follows:

\begin{equation}
\small
\varDelta \left(MPS^{n}\right) = \rho^{MPS,R} . \varDelta \left(R - \frac{\varDelta \left(P\right)}{P_{t-1}}\right) + \rho^{MPS,UnR} . \varDelta \left(UnR\right)
\end{equation}

